[{"created":"20220505193946834","creator":"Telumire","text":"\\define read-only-filter()\n    [[TiddlyWiki Safe Mode]is[tiddler]]\n    [{$:/status/IsLoggedIn}match[yes]]\n    [{$:/info/url/protocol}match[file:]]\n    [{$:/info/url/hostname}match[localhost]]\n\\end\n\\define checkbox(state)\n<input type=checkbox $state$/>\n\\end\n\\define toggle-visibility(filter,stateFilter,field)\n<$list filter=\"$filter$\" variable=\"toggle\">\n    <div>\n        <$button class=\"tc-btn-invisible\" actions=\"\"\"<$action-listops  $field=\"$field$\" $subfilter=\"+[toggle<toggle>]\" />\"\"\">\n            <$macrocall $name=\"checkbox\" state={{{ [is[current]list[!!$field$]match<toggle>then[]else[checked]] }}}/>\n        </$button>\n        <span class=\"tc-icon-wrapper\">\n            <$tiddler tiddler=<<toggle>> >\n                <$transclude tiddler={{!!icon}}/> <$transclude field=\"caption\"/>\n                -- <i class=\"tc-muted\">\n                    <$transclude field=\"description\"><$transclude field=\"title\"/></$transclude>\n                </i>\n            </$tiddler>\n        </span>\n    </div>\n</$list>\n\\end\n<$tiddler tiddler=\"$:/TiddlyTweaks/ReadOnly\">\n    <!-- UI -->\n    <p>\n        Check the buttons and tabs that ''can'' be displayed in read only mode.\n    </p>\n    <h4><strong>View toolbar</strong></h4>\n\n    <$macrocall $name=\"toggle-visibility\" filter=\"[[$:/tags/ViewToolbar]tagging[]]\" field=\"ViewToolbarButtons\"/>\n\n    <h4><strong>Page controls</strong></h4>\n\n    <$macrocall $name=\"toggle-visibility\" filter=\"[[$:/tags/PageControls]tagging[]]\" field=\"PageControlButtons\"/>\n\n    <h4><strong>Sidebar tabs</strong></h4>\n\n    <$macrocall $name=\"toggle-visibility\" filter=\"[all[tiddlers+shadows]search:title:anchored[$:/core/ui/SideBar/]]\" field=\"SideBarSegments/tabs\"/>\n\n    <h4><strong>CSS rules for read-only</strong></h4>\n\n    <$edit-text field=\"ReadOnlyCSS\" tag=\"textarea\" class=\"tc-edit-texteditor full-width\"/>\n\n    <!-- UI Style -->\n    <style>textarea.tc-edit-texteditor.full-width{width:100%!important;}</style>\n\n    <$vars read-only={{{ [subfilter<read-only-filter>then[false]else[true]] }}}>\n        <!-- ReadOnly Style -->\n            <$list filter=\"[<read-only>match[true]]\" variable=_>\n                <style>{{!!ReadOnlyCSS}}</style>\n            </$list>\n        <!-- Actions -->\n        <$list filter=\"[list[!!config-visibility]]\" variable=\"UI-elements\">\n            <$list filter=\"[<currentTiddler>get<UI-elements>enlist-input[]]\" variable=\"UI-element\">\n                <!-- config visibility -->\n                <$list filter=\"[<UI-elements>search:title[Buttons]]\" variable=_>\n                    <$tiddler tiddler={{{ $:/config/[<UI-elements>]/Visibility/[<UI-element>]+[join[]] }}}>\n                         <$list filter=\"[<read-only>match[true]]\" variable=_>\n                             <!-- store initial visibility value -->\n                             <$action-setfield initial={{!!text}}/>\n                             <!-- change visibility value to hide -->\n                             <$action-setfield text=\"hide\"/>\n                         </$list>\n                         <$list filter=\"[is[current]has[initial]]:filter[<read-only>match[false]]\" variable=_>\n                             <!-- restore initial visibility value -->\n                             <$action-setfield text={{!!initial}} />\n                         </$list>\n                    </$tiddler>\n                </$list>\n                <!-- toggle tags -->\n                <$list filter=\"[<UI-elements>search:title[tabs]]:filter[<read-only>match[true]]\" variable=\"_\" >\n                    <$action-listops  $tiddler=<<UI-element>> $tags=\"-[[$:/tags/SideBar]]\" />\n                </$list>\n                <$list filter=\"[<UI-elements>search:title[tabs]]:filter[<read-only>match[false]]\" variable=\"_\" >\n                    <$action-listops  $tiddler=<<UI-element>> $tags=\"+[[$:/tags/SideBar]]\" />\n                </$list>\n            </$list>\n        </$list>\n        \n        <!-- Set current tab -->\n        <$action-listops  $tiddler=\"$:/state/tab/sidebar--595412856\" $field=\"text\" $filter=\"[[$:/tags/SideBar]tagging[]nth[1]]\"/>\n        \n        <!-- Disable save warning-->\n        <$list filter=\"[<read-only>match[true]]\" variable=\"_\" emptyMessage=\"\"\"\n            <$action-setfield $tiddler=\"$:/config/SaverFilter\" text={{{ [{$:/config/SaverFilter}prefix[-]removeprefix[-]]~[{$:/config/SaverFilter}]}}}/>\n        \"\"\">\n            <$action-setfield $tiddler=\"$:/config/SaverFilter\" text={{{ [{$:/config/SaverFilter}prefix[-]]~[{$:/config/SaverFilter}addprefix[-]]}}}/>\n        </$list>\n    </$vars>\n</$tiddler>","title":"$:/TiddlyTweaks/ReadOnly","PageControlButtons":"$:/core/ui/Buttons/save-wiki $:/core/ui/Buttons/new-tiddler $:/core/ui/Buttons/import $:/core/ui/Buttons/control-panel $:/core/ui/Buttons/advanced-search $:/core/ui/Buttons/manager $:/core/ui/Buttons/tag-manager $:/core/ui/Buttons/encryption $:/core/ui/Buttons/timestamp $:/core/ui/Buttons/more-page-actions $:/core/ui/Buttons/new-journal $:/core/ui/Buttons/new-image","SideBarSegments/tabs":"$:/core/ui/SideBar/Tools $:/core/ui/SideBar/More","ViewToolbarButtons":"$:/core/ui/Buttons/edit $:/core/ui/Buttons/more-tiddler-actions $:/core/ui/Buttons/delete $:/core/ui/Buttons/new-here $:/core/ui/Buttons/new-journal-here $:/core/ui/Buttons/clone","config-visibility":"PageControlButtons ViewToolbarButtons SideBarSegments/tabs","modified":"20220618165326185","modifier":"Telumire","tags":"$:/tags/StartupAction $:/tags/Stylesheet $:/tags/ControlPanel/Appearance","type":"text/vnd.tiddlywiki","revision":"0","bag":"default","ReadOnlyCSS":".tc-sidebar-search [aria-label=\"{{$:/language/Buttons/AdvancedSearch/Caption}}\"]{    \ndisplay:none;\n}","caption":"Read Only"}]